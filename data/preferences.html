<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preferences Configuration</title>
</head>
<body>

<h1>Preferences Configuration</h1>

<form id="preferencesForm">
    <!-- Calibration -->
    <label for="customCalibrationValue">Custom Calibration Value:</label>
    <input type="number" id="customCalibrationValue" name="customCalibrationValue"><br>

    <!-- Temperature Offset -->
    <label for="tempOffset">Temperature Offset:</label>
    <input type="number" step="0.1" id="tempOffset" name="tempOffset"><br>

    <!-- Altitude -->
    <label for="altitudeMeters">Altitude (meters):</label>
    <input type="number" id="altitudeMeters" name="altitudeMeters"><br>

    <!-- Auto Calibration -->
    <label for="autoSelfCalibration">Auto Self Calibration:</label>
    <input type="checkbox" id="autoSelfCalibration" name="autoSelfCalibration"><br>

    <!-- CO2 Ranges -->
    <label for="co2OrangeRange">CO2 Orange Range:</label>
    <input type="number" id="co2OrangeRange" name="co2OrangeRange"><br>
    <label for="co2RedRange">CO2 Red Range:</label>
    <input type="number" id="co2RedRange" name="co2RedRange"><br>

    <!-- Display Brightness -->
    <label for="displayBrightness">Display Brightness:</label>
    <input type="number" id="displayBrightness" name="displayBrightness"><br>

    <!-- NeoPixel Brightness -->
    <label for="neopixelBrightness">NeoPixel Brightness:</label>
    <input type="number" id="neopixelBrightness" name="neopixelBrightness"><br>

    <!-- Selected NeoPixel Type -->
    <label for="selectedNeopixelType">Selected NeoPixel Type:</label>
    <input type="number" id="selectedNeopixelType" name="selectedNeopixelType"><br>

    <!-- BLE, WIFI, MQTT, ESPNOW -->
    <label for="activeBLE">Active BLE:</label>
    <input type="checkbox" id="activeBLE" name="activeBLE"><br>
    <label for="activeWIFI">Active WIFI:</label>
    <input type="checkbox" id="activeWIFI" name="activeWIFI"><br>
    <label for="activeMQTT">Active MQTT:</label>
    <input type="checkbox" id="activeMQTT" name="activeMQTT"><br>
    <label for="activeESPNOW">Active ESPNOW:</label>
    <input type="checkbox" id="activeESPNOW" name="activeESPNOW"><br>

    <!-- Root Topic -->
    <label for="rootTopic">Root Topic:</label>
    <input type="text" id="rootTopic" name="rootTopic"><br>

    <!-- Battery Millivolts -->
    <label for="batteryDischargedMillivolts">Battery Discharged Millivolts:</label>
    <input type="number" id="batteryDischargedMillivolts" name="batteryDischargedMillivolts"><br>
    <label for="batteryFullyChargedMillivolts">Battery Fully Charged Millivolts:</label>
    <input type="number" id="batteryFullyChargedMillivolts" name="batteryFullyChargedMillivolts"><br>

    <!-- VRef -->
    <label for="vRef">VRef:</label>
    <input type="number" id="vRef" name="vRef"><br>

    <!-- MQTT Credentials -->
    <label for="mqttClientId">MQTT Client ID:</label>
    <input type="text" id="mqttClientId" name="mqttClientId"><br>
    <label for="mqttBroker">MQTT Broker:</label>
    <input type="text" id="mqttBroker" name="mqttBroker"><br>
    <label for="mqttUser">MQTT User:</label>
    <input type="text" id="mqttUser" name="mqttUser"><br>
    <label for="mqttPass">MQTT Password:</label>
    <input type="password" id="mqttPass" name="mqttPass"><br>

    <!-- Time Settings -->
    <label for="timeToDisplayOff">Time to Display Off (seconds):</label>
    <input type="number" id="timeToDisplayOff" name="timeToDisplayOff"><br>
    <label for="timeBetweenMQTTPublish">Time Between MQTT Publish (seconds):</label>
    <input type="number" id="timeBetweenMQTTPublish" name="timeBetweenMQTTPublish"><br>
    <label for="timeBetweenESPNowPublish">Time Between ESPNOW Publish (seconds):</label>
    <input type="number" id="timeBetweenESPNowPublish" name="timeBetweenESPNowPublish"><br>
    <label for="timeToKeepAliveMQTT">Time to Keep Alive MQTT (seconds):</label>
    <input type="number" id="timeToKeepAliveMQTT" name="timeToKeepAliveMQTT"><br>
    <label for="timeToKeepAliveESPNow">Time to Keep Alive ESPNOW (seconds):</label>
    <input type="number" id="timeToKeepAliveESPNow" name="timeToKeepAliveESPNow"><br>

    <!-- Display Off on External Power -->
    <label for="displayOffOnExternalPower">Display Off on External Power:</label>
    <input type="checkbox" id="displayOffOnExternalPower" name="displayOffOnExternalPower"><br>

    <!-- WiFi Credentials -->
    <label for="wifiSSID">WiFi SSID:</label>
    <input type="text" id="wifiSSID" name="wifiSSID"><br>
    <label for="wifiPass">WiFi Password:</label>
    <input type="password" id="wifiPass" name="wifiPass"><br>

    <!-- Host Name -->
    <label for="hostName">Host Name:</label>
    <input type="text" id="hostName" name="hostName"><br>

    <!-- Selected CO2 Sensor -->
    <label for="selectedCO2Sensor">Selected CO2 Sensor:</label>
    <input type="number" id="selectedCO2Sensor" name="selectedCO2Sensor"><br>

    <!-- Sensor Debug -->
    <label for="debugSensors">Debug Sensors:</label>
    <input type="checkbox" id="debugSensors" name="debugSensors"><br>

    <!-- Display Reverse -->
    <label for="displayReverse">Display Reverse:</label>
    <input type="checkbox" id="displayReverse" name="displayReverse"><br>

    <!-- Show Fahrenheit -->
    <label for="showFahrenheit">Show Fahrenheit:</label>
    <input type="checkbox" id="showFahrenheit" name="showFahrenheit"><br>

    <!-- Measurement Interval -->
    <label for="measurementInterval">Measurement Interval (seconds):</label>
    <input type="number" id="measurementInterval" name="measurementInterval"><br>

    <!-- Outputs Mode Relay -->
    <label for="outputsModeRelay">Outputs Mode Relay:</label>
    <input type="checkbox" id="outputsModeRelay" name="outputsModeRelay"><br>

    <!-- ESP-NOW Settings -->
    <label for="channelESPNow">ESP-NOW Channel:</label>
    <input type="number" id="channelESPNow" name="channelESPNow"><br>
    <label for="boardIdESPNow">ESP-NOW Board ID:</label>
    <input type="number" id="boardIdESPNow" name="boardIdESPNow"><br>
    <label for="peerESPNowAddress">ESP-NOW Peer Address:</label>
    <input type="text" id="peerESPNowAddress" name="peerESPNowAddress"><br>

    <!-- Display Preferences -->
    <label for="displayShowTemperature">Display Show Temperature:</label>
    <input type="checkbox" id="displayShowTemperature" name="displayShowTemperature"><br>
    <label for="displayShowHumidity">Display Show Humidity:</label>
    <input type="checkbox" id="displayShowHumidity" name="displayShowHumidity"><br>
    <label for="displayShowBattery">Display Show Battery:</label>
    <input type="checkbox" id="displayShowBattery" name="displayShowBattery"><br>
    <label for="displayShowCO2">Display Show CO2:</label>
    <input type="checkbox" id="displayShowCO2" name="displayShowCO2"><br>
    <label for="displayShowPM25">Display Show PM25:</label>
    <input type="checkbox" id="displayShowPM25" name="displayShowPM25"><br>

    <button type="button" onclick="savePreferences()">Save Preferences</button>
</form>

<script>
    function savePreferences() {
        // Collect preferences data from the form
        var preferencesData = {};
        preferencesData.customCalibrationValue = document.getElementById('customCalibrationValue').value;
        preferencesData.tempOffset = document.getElementById('tempOffset').value;
        preferencesData.altitudeMeters = document.getElementById('altitudeMeters').value;
        preferencesData.autoSelfCalibration = document.getElementById('autoSelfCalibration').checked;
        preferencesData.co2OrangeRange = document.getElementById('co2OrangeRange').value;
        preferencesData.co2RedRange = document.getElementById('co2RedRange').value;
        preferencesData.displayBrightness = document.getElementById('displayBrightness').value;
        preferencesData.neopixelBrightness = document.getElementById('neopixelBrightness').value;
        preferencesData.selectedNeopixelType = document.getElementById('selectedNeopixelType').value;
        preferencesData.activeBLE = document.getElementById('activeBLE').checked;
        preferencesData.activeWIFI = document.getElementById('activeWIFI').checked;
        preferencesData.activeMQTT = document.getElementById('activeMQTT').checked;
        preferencesData.activeESPNOW = document.getElementById('activeESPNOW').checked;
        preferencesData.rootTopic = document.getElementById('rootTopic').value;
        preferencesData.batteryDischargedMillivolts = document.getElementById('batteryDischargedMillivolts').value;
        preferencesData.batteryFullyChargedMillivolts = document.getElementById('batteryFullyChargedMillivolts').value;
        preferencesData.vRef = document.getElementById('vRef').value;
        preferencesData.mqttClientId = document.getElementById('mqttClientId').value;
        preferencesData.mqttBroker = document.getElementById('mqttBroker').value;
        preferencesData.mqttUser = document.getElementById('mqttUser').value;
        preferencesData.mqttPass = document.getElementById('mqttPass').value;
        preferencesData.timeToDisplayOff = document.getElementById('timeToDisplayOff').value;
        preferencesData.timeBetweenMQTTPublish = document.getElementById('timeBetweenMQTTPublish').value;
        preferencesData.timeBetweenESPNowPublish = document.getElementById('timeBetweenESPNowPublish').value;
        preferencesData.timeToKeepAliveMQTT = document.getElementById('timeToKeepAliveMQTT').value;
        preferencesData.timeToKeepAliveESPNow = document.getElementById('timeToKeepAliveESPNow').value;
        preferencesData.displayOffOnExternalPower = document.getElementById('displayOffOnExternalPower').checked;
        preferencesData.wifiSSID = document.getElementById('wifiSSID').value;
        preferencesData.wifiPass = document.getElementById('wifiPass').value;
        preferencesData.hostName = document.getElementById('hostName').value;
        preferencesData.selectedCO2Sensor = document.getElementById('selectedCO2Sensor').value;
        preferencesData.debugSensors = document.getElementById('debugSensors').checked;
        preferencesData.displayReverse = document.getElementById('displayReverse').checked;
        preferencesData.showFahrenheit = document.getElementById('showFahrenheit').checked;
        preferencesData.measurementInterval = document.getElementById('measurementInterval').value;
        preferencesData.outputsModeRelay = document.getElementById('outputsModeRelay').checked;
        preferencesData.channelESPNow = document.getElementById('channelESPNow').value;
        preferencesData.boardIdESPNow = document.getElementById('boardIdESPNow').value;
        preferencesData.peerESPNowAddress = document.getElementById('peerESPNowAddress').value;
        preferencesData.displayShowTemperature = document.getElementById('displayShowTemperature').checked;
        preferencesData.displayShowHumidity = document.getElementById('displayShowHumidity').checked;
        preferencesData.displayShowBattery = document.getElementById('displayShowBattery').checked;
        preferencesData.displayShowCO2 = document.getElementById('displayShowCO2').checked;
        preferencesData.displayShowPM25 = document.getElementById('displayShowPM25').checked;

        // Send the preferences data to the server
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/savePreferences", true);
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhr.send(JSON.stringify(preferencesData));

        // Handle the response from the server
        xhr.onload = function () {
            if (xhr.status === 200) {
                alert("Preferences updated successfully!");
            } else {
                alert("Error updating preferences. Please try again.");
            }
        };
    }
</script>

</body>
</html>
